
R version 4.1.2 (2021-11-01) -- "Bird Hippie"
Copyright (C) 2021 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> library(phylopomp)

Attaching package: ‘phylopomp’

The following object is masked from ‘package:stats’:

    simulate

> set.seed(94329846)
> 
> png(filename="diagram-01.png",res=100,
+   width=318,height=256,units="px")
> simulate("SIR",time=1) |> diagram()
> dev.off()
null device 
          1 
> 
> png(filename="diagram-02.png",res=100,
+   width=511,height=134,units="px")
> simulate("SIIR",Beta2=20,psi2=0.1,I2_0=2,time=0.5) |> diagram()
> dev.off()
null device 
          1 
> 
> simulate("SIIR",time=0.3) |>
+   getInfo(description=TRUE) |>
+   getElement("description") |>
+   cat()
time = 0.300000
node(6,0) {green(6), green(10)}, t = 0.000000
node(5,0) {green(5), green(11)}, t = 0.000000
node(10,0) {red(6), blue(10)}, t = 0.036681
node(11,0) {red(5), blue(11)}, t = 0.124368
> 
> simulate("SIR",time=0.5) |>
+   getInfo(yaml=TRUE,t0=TRUE,prune=FALSE) |>
+   getElement("yaml") |>
+   cat()
parameter:
  Beta: 2.000000
  gamma: 1.000000
  psi: 1.000000
  S0: 100
  I0: 2
  R0: 0
state:
  S: 100.000000
  I: 1.000000
  R: 1.000000
genealogy:
  ndemes: 1
  time: 0.500000
  nodes:
  - name: 1
    deme: 0
    time: 0.000000
    pocket:
    - color: green
      name: 1
    - color: black
      name: 1
      deme: 0
> 
> simulate("LBDP",time=0.5) |>
+   getInfo(yaml=TRUE) |>
+   getElement("yaml") |>
+   cat()
parameter:
  lambda: 2.000000
  mu: 1.000000
  psi: 1.000000
  n0: 5
state:
  n: 12.000000
genealogy:
  ndemes: 1
time: 0.500000
nodes:
- name: 4
  deme: 0
  time: 0.000000
  pocket:
  - color: green
    name: 4
  - color: green
    name: 13
- name: 3
  deme: 0
  time: 0.000000
  pocket:
  - color: green
    name: 3
  - color: green
    name: 16
- name: 1
  deme: 0
  time: 0.000000
  pocket:
  - color: green
    name: 1
  - color: green
    name: 7
- name: 0
  deme: 0
  time: 0.000000
  pocket:
  - color: green
    name: 0
  - color: green
    name: 9
- name: 7
  deme: 0
  time: 0.128620
  pocket:
  - color: blue
    name: 7
  - color: green
    name: 17
- name: 9
  deme: 0
  time: 0.232253
  pocket:
  - color: red
    name: 0
  - color: blue
    name: 9
- name: 13
  deme: 0
  time: 0.373606
  pocket:
  - color: red
    name: 4
  - color: blue
    name: 13
- name: 16
  deme: 0
  time: 0.427337
  pocket:
  - color: red
    name: 3
  - color: blue
    name: 16
- name: 17
  deme: 0
  time: 0.492345
  pocket:
  - color: red
    name: 12
  - color: blue
    name: 17
> 
> try(
+   simulate("SIR",time=1) |>
+     simulate(time=0.1)
+ )
Error : cannot simulate backward! (current t=1, requested t=0.1)
> 
