name: Strains
description: Three strains compete for a single susceptible pool.
details: |-
  The three demes are three distinct pathogen strains that compete for susceptibles.
demes:
  - strain1
  - strain2
  - strain3
parameter:
  Beta1:
    name: Beta1
    description: transmission rate for strain 1
    type: double
    default: 5
  Beta2:
    name: Beta2
    description: transmission rate for strain 2
    type: double
    default: 5
  Beta3:
    name: Beta3
    description: transmission rate for strain 3
    type: double
    default: 5
  gamma:
    name: gamma
    description: recovery rate
    type: double
    default: 1
  psi1:
    name: psi1
    description: sampling rate for strain 1
    default: 1
    type: double
  psi2:
    name: psi2
    description: sampling rate for strain 2
    default: 0
    type: double
  psi3:
    name: psi3
    description: sampling rate for strain 3
    default: 0
    type: double
ivp:
  S0:
    name: S0
    description: initial size of susceptible population
    default: 10000
    type: int
  I1_0:
    name: I1_0
    description: initial number of strain-1 infections
    default: 10
    type: int
  I2_0:
    name: I2_0
    description: initial number of strain-2 infections
    default: 10
    type: int
  I3_0:
    name: I3_0
    description: initial number of strain-3 infections
    default: 10
    type: int
  R0:
    name: R0
    description: initial size of immune population
    default: 0
    type: int
state:
  S:
    name: S
    type: int
  I1:
    name: I1
    type: int
  I2:
    name: I2
    type: int
  I3:
    name: I3
    type: int
  R:
    name: R
    type: int
  'N':
    name: 'N'
    type: double
rinit: |-
    state.S = params.S0;
    state.I1 = params.I1_0;
    state.I2 = params.I2_0;
    state.I3 = params.I3_0;
    state.R = params.R0;
    state.N = double(params.S0+params.I1_0+params.I3_0+params.I3_0+params.R0);
    graft(strain1,params.I1_0);
    graft(strain2,params.I2_0);
    graft(strain3,params.I3_0);
events:
  infec1:
    rate: params.Beta1 * state.S * state.I1 / state.N
    jump: state.S -= 1; state.I1 += 1; birth(strain1,strain1);
  infec2:
    rate: params.Beta2 * state.S * state.I2 / state.N
    jump: state.S -= 1; state.I2 += 1; birth(strain2,strain2);
  infec3:
    rate: params.Beta3 * state.S * state.I3 / state.N
    jump: state.S -= 1; state.I3 += 1; birth(strain3,strain3);
  recov1:
    jump: state.I1 -= 1; state.R += 1; death(strain1);
    rate: params.gamma * state.I1
  recov2:
    jump: state.I2 -= 1; state.R += 1; death(strain2);
    rate: params.gamma * state.I2
  recov3:
    jump: state.I3 -= 1; state.R += 1; death(strain3);
    rate: params.gamma * state.I3
  sample1:
    rate: params.psi1 * state.I1
    jump: state.I1 -= 1; state.R += 1; sample_death(strain1);
  sample2:
    rate: params.psi2 * state.I2
    jump: state.I2 -= 1; state.R += 1; sample_death(strain2);
  sample3:
    rate: params.psi3 * state.I3
    jump: state.I3 -= 1; state.R += 1; sample_death(strain3);
